# Financial Dashboard

## 技术栈
- React 18 + TypeScript
- TailwindCSS 3
- ECharts 5 数据可视化

## 目录结构
```
project/
├── src/
│   ├── components/          # 可复用组件
│   │   ├── charts/          # 图表组件库
│   │   │   ├── DetailedBarChart.tsx   # 多维度柱状图
│   │   │   ├── DistributionPieChart.tsx # 分布饼图
│   │   │   ├── TreemapChart.tsx      # 成本结构分析树图
│   │   │   ├── TrendChart.tsx        # 趋势折线图
│   │   │   ├── USDInvestmentChart.tsx # 投资分析图表
│   │   │   └── WaterfallChart.tsx    # 财务数据流向瀑布图
│   │   ├── common/          # 公共组件
│   │   │   ├── ChartContainer.tsx    # 图表容器组件
│   │   │   ├── LoadingIndicator.tsx  # 加载指示器
│   │   │   └── SummaryTable.tsx      # 汇总表格
│   │   ├── Dashboard.tsx    # 核心仪表盘组件
│   │   └── Header.tsx       # 全局导航组件
│   ├── data/
│   │   ├── app_totals_*.json # 财务数据JSON文件
│   │   ├── cal_price.py     # 价格计算脚本
│   │   ├── convertJsonToMockData.ts # JSON转模拟数据工具
│   │   ├── dataProcessor.ts # 数据清洗转换处理器
│   │   ├── dataTypes.ts     # TypeScript类型定义
│   │   ├── mockData.ts      # 模拟数据
│   │   ├── mockData_origin.ts # 原始模拟数据
│   │   └── personal_page.xlsx    # Excel记账模板
├── eslint.config.js       # ESLint配置
├── index.html             # 应用入口HTML
├── package.json           # 依赖管理
├── postcss.config.js      # PostCSS配置
├── tailwind.config.js     # TailwindCSS配置
├── tsconfig.app.json      # TypeScript应用配置
├── tsconfig.json          # TypeScript主配置
├── tsconfig.node.json     # TypeScriptNode配置
└── vite.config.ts         # Vite构建配置
```

## 核心功能
### 数据处理系统
- `dataProcessor.ts`：提供数据标准化、格式转换和校验功能
- `dataTypes.ts`：定义财务数据相关TS类型（IncomeStatement等）

### 可视化系统
- 基于ECharts封装的可复用图表组件
- 支持动态主题切换（通过TailwindCSS实现）
- 图表类型包含：
  - 瀑布图（财务数据流向）
  - 雷达图（多维度指标对比）
  - 树图（成本结构分析）

## 开发指南
```bash
# 安装依赖
npm install

node server/index.js
# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 新增数据说明

```
1、在src\data\personal_page.xlsx中更新全部的最新数据
2、打开src\data\cal_price.py，执行该脚本
3、npm run convert-data 将最新的数据合入到src\data\mockData.ts中
4、刷新界面，查看更新后的数据
```



## 依赖说明

- 核心依赖：`echarts-for-react`实现图表集成
- 样式系统：TailwindCSS + Lucide图标库
- 代码规范：ESLint + React Hooks校验规则

### 20250501

1、4月基金定投了12300元，
2、4月的基金收益为-374.55
3、5月1号的基金总额为17953.61
4、5月1号的基金历史总亏损为-480.98
5、5月1号的支付宝总额为26153.97
6、4月1号的支付宝总额为10074
~~7、4月的养老金增加了41元~~
~~8、5月1号的养老金为3100~~
9、4月1号的余利宝余额为11.8
10、5月1号的余利宝余额为5002.86

11、4月1号余额宝总额为878.55，17号转移879到工行卡，目前为0

得出：
31、由3+4得出，5月1日的基金本金为18,434.59，这个不对，4是历史总亏损
32、由31-1得出，4月1日的基金本金为16,034.59，这个不对，31的数据就是错的，实际应该为
~~33、由8-7得出，4月1号的养老金为3059~~

34、由10-9得出，4月份余利宝增加了4,991.06
35、4月增加的金额10074+4,991.06+41-879+12300-374.55=26152.51

36、4月1号的金额组成(37+9+33+11)，10074=6,028.16+11.8+3059+878.55+97.5=10,075.01

37、4月1号的基金总额3-2-1=17953.61+374.55-12300=6,028.16

38、5月1号的金额组成，基金总额+余利宝+养老金+余额宝+余额=26153.97=17953.61+5002.86+3100+0+97.5

#### 3月支付宝计算

3月1日支付宝总额为10080=基金总额+养老金+余利宝+余额宝+余额=6,043.64+3018+11.8+97.5+909.42=10080.36

首先计算基金总额，4月基金总额-3月收益-定投金额=6,028.16+15.48=6,043.64

养老金，增加了41元，3059-41=3018

余额，97.5

余额宝，909.42

#### 2月支付宝计算

2月1日支付宝总额为10251=基金总额+养老金+余利宝+余额+余额宝=6,204.82+2976+2.96+97.5+970.62=10251.9

首先计算基金总额，3月基金总额-2月收益-定投金额=6,043.64+161.18=6,204.82

养老金，增加了42元，3018-42=2976

余额，97.5

余额宝，970.62

余利宝，2.96

#### 1月支付宝计算

1月1日支付宝总额为14947=基金总额+养老金+余利宝+余额+余额宝=11,254.07+2935+121.28+97.5+550.03=14957.88

首先计算基金总额，2月基金总额-1月收益-定投金额+卖出总额=6,204.82-396.73+5,445.98=11,254.07      11,254.07+126.98=11,381.05

卖出总额=2695.14+2750.84=5,445.98

养老金，增加了41元，2976-41=2935

余利宝，121.28

余额，97.5

余额宝，550.03

### 待修改
目前每次更新完成个人记账.xlsx后，需要手动运行cal_price.py脚本，将xlsx转换为json文件，
然后再运行npm run convert-data脚本，生成模拟数据。
需要简化这些步骤，自动完成。

#### 0501

在总资产趋势下方添加目标收益率展示，需要展示的内容包括，最新日期的总金额，目标年收益率（需要手动填写），最新收益总额（最新日期的总收益额-当年一月的总收益额），最新收益的年收益率（最新收益总额/(当前月份-当年一月)*12）

在收益率分析增加，平均每月收益（当年收益总额/月份），还有按照当前的平均每月收益还需要几个月才能达到目标收益率

#### 0511

将月度变化和美元投资月度变化合并到一起，通过点击来切换

增加人民币理财投资月度变化，和月度变化和美元投资月度变化合并到一起，通过点击来切换

89675.75+22212.76=111,888.51

2340.32+742.86=3,083.18

89699.21+22142.9=111,842.11    111,842.11-111,888.51=-46.4

2363.78+673.0=3,036.78  3,036.78-3,083.18=

最新日期投资类型汇总增加一个下拉列表，可以选择查看不同日期的投资类型汇总

收益率分析增加攒钱目标，当前的攒钱目标是每个月攒1.25万元，需要展示的内容包括，当年已攒钱数（当前月份总额-一月份总额），目标攒钱数，月均攒钱数，攒钱目标达成所需月份

左上角新增按钮，可以选择是否展示非X月1号的数据，默认不展示非X月1号的数据

#### 0513

年化收益率==10000/购汇RMB价格\*实际收益/持有天数*365

现在需要添加新增数据按钮，对应APP的可选项为，工商银行，招商银行，网商银行，腾讯自选股，支付宝

理财名称需要手动填写，美元本金，购汇价需要手动填写，购汇RMB价格=美元本金*购汇价/100，

购买时间使用时间选择器勾选，当前美元数额=美元本金，结汇价=购汇价，

当前RMB数额=当前美元数额*结汇价/100，实际收益=当前RMB数额-购汇RMB价格

持有天数=当前日期-购买时间

年化收益率==10000/购汇RMB价格\*实际收益/持有天数*365

#### 0514

困惑的点，假如我在某一天赎回某个理财产品（删除相关的产品），与之对应的收益也一并被删除了，正常情况下，即便产品赎回，但是收益应该是保留的，要如何规避这种情况

| 对应APP  | 理财类型        | 理财名称 | 购买价格    | 购买时间   | 当前RMB数额 | 实际收益 | 日期       | 持有天数 | 对应的年化率 |      |
| -------- | --------------- | -------- | ----------- | ---------- | ----------- | -------- | ---------- | -------- | ------------ | ---- |
| 招商银行 | 理财/人民币理财 | 季季宝   | ￥20,000.00 | 2024/09/06 | ￥20,273.86 | 273.86   | 2025/05/15 | 251      | 199.12       |      |
| 网商银行 | 理财/人民币理财 | 徽银理财 | ￥20,000.00 | 2025/05/09 | ￥20,000.00 | 0.00     | 2025/05/15 | 6        | 0.00         |      |
| 网商银行 | 理财/人民币理财 | 平安理财 | ￥50,000.00 | 2025/04/18 | ￥50,057.86 | 57.86    | 2025/05/15 | 27       | 156.44       |      |

| 对应APP  | 理财类型 | 理财名称 | 当前RMB数额 | 日期       |
| -------- | -------- | -------- | ----------- | ---------- |
| 支付宝   | 存款     | 余额     | ￥97.50     | 2025/05/15 |
| 支付宝   | 存款     | 余利宝   | ￥5,064.11  | 2025/05/15 |
| 工商银行 | 存款     | 存款     | ￥3,273.69  | 2025/05/15 |

| 对应APP  | 理财类型 | 购买价格    | 当前RMB数额 | 实际收益  | 日期       |
| -------- | -------- | ----------- | ----------- | --------- | ---------- |
| 支付宝   | 基金     | ￥18,434.59 | ￥18,212.75 | ￥-221.84 | 2025/05/15 |
| 工商银行 | 基金     | ￥30,000.00 | ￥30,120.51 | ￥120.51  | 2025/05/15 |

| 对应APP  | 理财类型 | 当前RMB数额 | 日期       |
| -------- | -------- | ----------- | ---------- |
| 支付宝   | 养老金   | ￥3,120.00  | 2025/05/15 |
| 招商银行 | 养老金   | ￥12,002.79 | 2025/05/15 |

| 对应APP    | 理财类型 | 购买价格    | 当前RMB数额 | 实际收益 | 日期       |
| ---------- | -------- | ----------- | ----------- | -------- | ---------- |
| 腾讯自选股 | 股票     | ￥26,000.00 | ￥26,912.33 | ￥912.33 | 2025/05/15 |